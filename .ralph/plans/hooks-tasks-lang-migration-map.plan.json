{
  "goal": "Migrate selected hook orchestration and user-facing texts from shell scripts to declarative hooks/tasks/lang config with safe, testable incremental changes.",
  "max_steps": 12,
  "steps": [
    {
      "id": "step-1",
      "description": "Baseline current behavior by running the project test entrypoint and capturing existing hook/task execution outputs for a representative run.",
      "acceptance": "`tests/run.sh` completes and a saved baseline log includes before-session, quality-gate, and after-step hook traces.",
      "status": "completed",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:48Z",
      "completed_at": "2026-02-20T15:04:48Z"
    },
    {
      "id": "step-2",
      "description": "Add config path support so `tasks.jsonc` is resolved as primary with fallback to `.ralph/tasks.json`.",
      "acceptance": "A config resolution test proves `.ralph/tasks.jsonc` is chosen when present and `.ralph/tasks.json` is used when `.jsonc` is absent.",
      "status": "completed",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:49Z",
      "completed_at": "2026-02-20T15:04:49Z"
    },
    {
      "id": "step-3",
      "description": "Define new reusable tasks in tasks config: `issues-context`, `planning-generate`, `source-control-policy`, `checkpoint-pre-session`, `testing-run`, and `metrics-step-summary`.",
      "acceptance": "Task parser loads all six task IDs without errors, and a dry-run lists each task exactly once.",
      "status": "completed",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:50Z",
      "completed_at": "2026-02-20T15:04:50Z"
    },
    {
      "id": "step-4",
      "description": "Wire `issues-context`, `planning-generate`, `source-control-policy`, and `checkpoint-pre-session` into `before-session.system` in hooks config with explicit `when` conditions.",
      "acceptance": "Hook engine dry-run shows the new before-session task order and correctly skips/runs checkpoint based on `RALPH_CHECKPOINT_ENABLED` and `RALPH_DRY_RUN`.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-5",
      "description": "Wire `testing-run` and step-scoped `human-gate` into `quality-gate.after-system` using scope-based conditions.",
      "acceptance": "Quality-gate dry-run shows `testing-run` and `human-gate` execution decisions matching scope `step`/`both` rules.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-6",
      "description": "Wire `metrics-step-summary` into `after-step.after-system` and remove equivalent direct orchestration call sites from shell where replaced.",
      "acceptance": "After-step run logs metrics through the task path, and no duplicate metric logging occurs.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-7",
      "description": "Move newly identified user-facing strings to `.ralph/lang/no.json`, `.ralph/lang/en.json`, and `.ralph/lang/sv.json` using stable language keys.",
      "acceptance": "Language lookup tests confirm all new keys resolve in `no`, `en`, and `sv` with no missing-key warnings during run.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-8",
      "description": "Refactor `before-session.sh` orchestration to keep only setup and remaining non-declarative flow (`run_plan_approval_gate` partial shell logic).",
      "acceptance": "Shell script no longer performs migrated orchestration steps directly, and functional behavior remains unchanged in integration run.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-9",
      "description": "Introduce focused tests for migrated declarative flow: task resolution, hook phase ordering, conditional gates, and language-key presence.",
      "acceptance": "New/updated tests fail without migration changes and pass with migration changes.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-10",
      "description": "Run full regression suite and compare behavior against baseline logs to verify no unintended runtime regressions.",
      "acceptance": "`tests/run.sh` passes and baseline-vs-new comparison shows only expected orchestration-path differences.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-11",
      "description": "Document migration mapping and operational usage updates in repo docs (tasks/hook phases/lang keys and fallback behavior).",
      "acceptance": "Documentation references current files and IDs, and a maintainer can follow steps to locate each migrated responsibility.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    },
    {
      "id": "step-12",
      "description": "Finalize by validating that human-check behavior is controlled by hooks config and not hardcoded fallback shell branches.",
      "acceptance": "Review checklist passes: human checks are config-driven, runtime placement rules are respected, and all migration-related tests are green.",
      "status": "pending",
      "commit": null,
      "created_at": "2026-02-20T01:00:04Z",
      "updated_at": "2026-02-20T15:04:46Z",
      "completed_at": null
    }
  ],
  "generated_at": "2026-02-20T01:00:04Z",
  "updated_at": "2026-02-20T15:04:50Z",
  "approved_by": "oyvindg",
  "approved_at": "2026-02-20T15:04:47Z",
  "approval_source": "interactive"
}
